legend.title       = element_text(size = 12),
legend.background  = element_rect(fill = scales::alpha("white", 0.75), color = NA)
) +
guides(color = guide_legend(override.aes = list(linetype = 0, shape = 16, size = 3)))
df_mcq <- as.data.frame(emm_speed) %>%
transmute(speed,
estimate = prob,
lower    = asymp.LCL,
upper    = asymp.UCL,
outcome  = "MCQ accuracy")
# Slider: continuous scale
df_slider <- as.data.frame(emm_speed_slider) %>%
transmute(speed,
estimate = emmean,
lower    = lower.CL,
upper    = upper.CL,
outcome  = "Slider response")
df_plot <- bind_rows(df_mcq, df_slider)
# --- significance labels (fast vs slow) ---
sig_lab <- function(p) ifelse(p < .001, "***",
ifelse(p < .01,  "**",
ifelse(p < .05,  "*",  "ns")))
p_mcq    <- as.data.frame(contrast(emm_speed,        method = "revpairwise"))$p.value[1]
p_slider <- as.data.frame(contrast(emm_speed_slider, method = "revpairwise"))$p.value[1]
lab_mcq     <- sig_lab(p_mcq)
lab_slider  <- sig_lab(p_slider)
# --- bracket geometry (kept close to dots; slider bracket a bit higher) ---
br_gap_mcq    <- 0.028     # above MCQ upper CI
br_gap_slider <- 0.055     # above Slider upper CI (further from dots)
br_tick       <- 0.018     # bracket tick length
star_off      <- 0.010     # stars closer to bracket
br_alpha      <- 0.2     # transparency for black brackets
y_mcq_br    <- pmin(0.97, max(df_mcq$upper,    na.rm = TRUE) + br_gap_mcq)
y_slider_br <- pmin(0.97, max(df_slider$upper, na.rm = TRUE) + br_gap_slider)
# if brackets too close, nudge slider one a touch more
if (abs(y_mcq_br - y_slider_br) < 0.03) y_slider_br <- pmin(0.97, y_mcq_br + 0.05)
# --- colors & legend text ---
cols <- c("MCQ accuracy"    = "#C2185B",  # deep pink
"Slider response" = "#6A3D9A")  # deep purple
legend_labels <- c("MCQ accuracy"    = "Multiple choice question",
"Slider response" = "Real-time comprehension")
# --- PLOT ---
ggplot(df_plot, aes(x = speed, y = estimate, group = outcome, color = outcome)) +
geom_line(linewidth = 1, show.legend = FALSE) +
geom_point(size = 3, shape = 16) +                                        # legend shows dots
geom_linerange(aes(ymin = lower, ymax = upper), linewidth = 0.9, show.legend = FALSE) +
scale_color_manual(values = cols, name = "Comprehension Measure", labels = legend_labels) +
# rename ticks: slow -> x1, fast -> x2.5
scale_x_discrete(labels = c(slow = "x1", fast = "x2.5"),
expand  = expansion(mult = c(0.05, 0.05))) +
scale_y_continuous(breaks = c(0, 0.5, 1), limits = c(0, 1)) +
coord_cartesian(clip = "off") +
labs(x = "Speech Rate", y = "Predicted Comprehension Score") +
# ---- MCQ bracket (semi-transparent black) + star ----
geom_segment(aes(x = 1, xend = 2, y = y_mcq_br, yend = y_mcq_br),
inherit.aes = FALSE, linewidth = 0.6, color = "black", alpha = br_alpha) +
geom_segment(aes(x = 1, xend = 1, y = y_mcq_br, yend = y_mcq_br - br_tick),
inherit.aes = FALSE, linewidth = 0.6, color = "black", alpha = br_alpha) +
geom_segment(aes(x = 2, xend = 2, y = y_mcq_br, yend = y_mcq_br - br_tick),
inherit.aes = FALSE, linewidth = 0.6, color = "black", alpha = br_alpha) +
annotate("text", x = 1.5, y = y_mcq_br + star_off, label = lab_mcq,
color = cols["MCQ accuracy"], size = 5) +
# ---- Slider bracket (higher) + star ----
geom_segment(aes(x = 1, xend = 2, y = y_slider_br, yend = y_slider_br),
inherit.aes = FALSE, linewidth = 0.6, color = "black", alpha = br_alpha) +
geom_segment(aes(x = 1, xend = 1, y = y_slider_br, yend = y_slider_br - br_tick),
inherit.aes = FALSE, linewidth = 0.6, color = "black", alpha = br_alpha) +
geom_segment(aes(x = 2, xend = 2, y = y_slider_br, yend = y_slider_br - br_tick),
inherit.aes = FALSE, linewidth = 0.6, color = "black", alpha = br_alpha) +
annotate("text", x = 1.5, y = y_slider_br + star_off, label = lab_slider,
color = cols["Slider response"], size = 5) +
theme_classic(base_size = 14) +
theme(
aspect.ratio       = 1,
axis.text.x        = element_text(size = 12),
axis.text.y        = element_text(size = 12),
legend.position    = "upper right", #c(0.98, 0.08),
legend.justification = c(1, 0),
legend.title       = element_text(size = 12),
legend.background  = element_rect(fill = scales::alpha("white", 0.75), color = NA)
) +
guides(color = guide_legend(override.aes = list(linetype = 0, shape = 16, size = 3)))
df_mcq <- as.data.frame(emm_speed) %>%
transmute(speed,
estimate = prob,
lower    = asymp.LCL,
upper    = asymp.UCL,
outcome  = "MCQ accuracy")
# Slider: continuous scale
df_slider <- as.data.frame(emm_speed_slider) %>%
transmute(speed,
estimate = emmean,
lower    = lower.CL,
upper    = upper.CL,
outcome  = "Slider response")
df_plot <- bind_rows(df_mcq, df_slider)
# --- significance labels (fast vs slow) ---
sig_lab <- function(p) ifelse(p < .001, "***",
ifelse(p < .01,  "**",
ifelse(p < .05,  "*",  "ns")))
p_mcq    <- as.data.frame(contrast(emm_speed,        method = "revpairwise"))$p.value[1]
p_slider <- as.data.frame(contrast(emm_speed_slider, method = "revpairwise"))$p.value[1]
lab_mcq     <- sig_lab(p_mcq)
lab_slider  <- sig_lab(p_slider)
# --- bracket geometry (kept close to dots; slider bracket a bit higher) ---
br_gap_mcq    <- 0.028     # above MCQ upper CI
br_gap_slider <- 0.055     # above Slider upper CI (further from dots)
br_tick       <- 0.018     # bracket tick length
star_off      <- 0.010     # stars closer to bracket
br_alpha      <- 0.2     # transparency for black brackets
y_mcq_br    <- pmin(0.97, max(df_mcq$upper,    na.rm = TRUE) + br_gap_mcq)
y_slider_br <- pmin(0.97, max(df_slider$upper, na.rm = TRUE) + br_gap_slider)
# if brackets too close, nudge slider one a touch more
if (abs(y_mcq_br - y_slider_br) < 0.03) y_slider_br <- pmin(0.97, y_mcq_br + 0.05)
# --- colors & legend text ---
cols <- c("MCQ accuracy"    = "#C2185B",  # deep pink
"Slider response" = "#6A3D9A")  # deep purple
legend_labels <- c("MCQ accuracy"    = "Multiple choice question",
"Slider response" = "Real-time comprehension")
# --- PLOT ---
ggplot(df_plot, aes(x = speed, y = estimate, group = outcome, color = outcome)) +
geom_line(linewidth = 1, show.legend = FALSE) +
geom_point(size = 3, shape = 16) +                                        # legend shows dots
geom_linerange(aes(ymin = lower, ymax = upper), linewidth = 0.9, show.legend = FALSE) +
scale_color_manual(values = cols, name = "Comprehension Measure", labels = legend_labels) +
# rename ticks: slow -> x1, fast -> x2.5
scale_x_discrete(labels = c(slow = "x1", fast = "x2.5"),
expand  = expansion(mult = c(0.05, 0.05))) +
scale_y_continuous(breaks = c(0, 0.5, 1), limits = c(0, 1)) +
coord_cartesian(clip = "off") +
labs(x = "Speech Rate", y = "Predicted Comprehension Score") +
# ---- MCQ bracket (semi-transparent black) + star ----
geom_segment(aes(x = 1, xend = 2, y = y_mcq_br, yend = y_mcq_br),
inherit.aes = FALSE, linewidth = 0.6, color = "black", alpha = br_alpha) +
geom_segment(aes(x = 1, xend = 1, y = y_mcq_br, yend = y_mcq_br - br_tick),
inherit.aes = FALSE, linewidth = 0.6, color = "black", alpha = br_alpha) +
geom_segment(aes(x = 2, xend = 2, y = y_mcq_br, yend = y_mcq_br - br_tick),
inherit.aes = FALSE, linewidth = 0.6, color = "black", alpha = br_alpha) +
annotate("text", x = 1.5, y = y_mcq_br + star_off, label = lab_mcq,
color = cols["MCQ accuracy"], size = 5) +
# ---- Slider bracket (higher) + star ----
geom_segment(aes(x = 1, xend = 2, y = y_slider_br, yend = y_slider_br),
inherit.aes = FALSE, linewidth = 0.6, color = "black", alpha = br_alpha) +
geom_segment(aes(x = 1, xend = 1, y = y_slider_br, yend = y_slider_br - br_tick),
inherit.aes = FALSE, linewidth = 0.6, color = "black", alpha = br_alpha) +
geom_segment(aes(x = 2, xend = 2, y = y_slider_br, yend = y_slider_br - br_tick),
inherit.aes = FALSE, linewidth = 0.6, color = "black", alpha = br_alpha) +
annotate("text", x = 1.5, y = y_slider_br + star_off, label = lab_slider,
color = cols["Slider response"], size = 5) +
theme_classic(base_size = 14) +
theme(
aspect.ratio       = 1,
axis.text.x        = element_text(size = 12),
axis.text.y        = element_text(size = 12),
legend.position    = " right", #c(0.98, 0.08),
legend.justification = c(1, 0),
legend.title       = element_text(size = 12),
legend.background  = element_rect(fill = scales::alpha("white", 0.75), color = NA)
) +
guides(color = guide_legend(override.aes = list(linetype = 0, shape = 16, size = 3)))
df_mcq <- as.data.frame(emm_speed) %>%
transmute(speed,
estimate = prob,
lower    = asymp.LCL,
upper    = asymp.UCL,
outcome  = "MCQ accuracy")
# Slider: continuous scale
df_slider <- as.data.frame(emm_speed_slider) %>%
transmute(speed,
estimate = emmean,
lower    = lower.CL,
upper    = upper.CL,
outcome  = "Slider response")
df_plot <- bind_rows(df_mcq, df_slider)
# --- significance labels (fast vs slow) ---
sig_lab <- function(p) ifelse(p < .001, "***",
ifelse(p < .01,  "**",
ifelse(p < .05,  "*",  "ns")))
p_mcq    <- as.data.frame(contrast(emm_speed,        method = "revpairwise"))$p.value[1]
p_slider <- as.data.frame(contrast(emm_speed_slider, method = "revpairwise"))$p.value[1]
lab_mcq     <- sig_lab(p_mcq)
lab_slider  <- sig_lab(p_slider)
# --- bracket geometry (kept close to dots; slider bracket a bit higher) ---
br_gap_mcq    <- 0.028     # above MCQ upper CI
br_gap_slider <- 0.055     # above Slider upper CI (further from dots)
br_tick       <- 0.018     # bracket tick length
star_off      <- 0.010     # stars closer to bracket
br_alpha      <- 0.2     # transparency for black brackets
y_mcq_br    <- pmin(0.97, max(df_mcq$upper,    na.rm = TRUE) + br_gap_mcq)
y_slider_br <- pmin(0.97, max(df_slider$upper, na.rm = TRUE) + br_gap_slider)
# if brackets too close, nudge slider one a touch more
if (abs(y_mcq_br - y_slider_br) < 0.03) y_slider_br <- pmin(0.97, y_mcq_br + 0.05)
# --- colors & legend text ---
cols <- c("MCQ accuracy"    = "#C2185B",  # deep pink
"Slider response" = "#6A3D9A")  # deep purple
legend_labels <- c("MCQ accuracy"    = "Multiple choice question",
"Slider response" = "Real-time comprehension")
# --- PLOT ---
ggplot(df_plot, aes(x = speed, y = estimate, group = outcome, color = outcome)) +
geom_line(linewidth = 1, show.legend = FALSE) +
geom_point(size = 3, shape = 16) +                                        # legend shows dots
geom_linerange(aes(ymin = lower, ymax = upper), linewidth = 0.9, show.legend = FALSE) +
scale_color_manual(values = cols, name = "Comprehension Measure", labels = legend_labels) +
# rename ticks: slow -> x1, fast -> x2.5
scale_x_discrete(labels = c(slow = "x1", fast = "x2.5"),
expand  = expansion(mult = c(0.05, 0.05))) +
scale_y_continuous(breaks = c(0, 0.5, 1), limits = c(0, 1)) +
coord_cartesian(clip = "off") +
labs(x = "Speech Rate", y = "Predicted Comprehension Score") +
# ---- MCQ bracket (semi-transparent black) + star ----
geom_segment(aes(x = 1, xend = 2, y = y_mcq_br, yend = y_mcq_br),
inherit.aes = FALSE, linewidth = 0.6, color = "black", alpha = br_alpha) +
geom_segment(aes(x = 1, xend = 1, y = y_mcq_br, yend = y_mcq_br - br_tick),
inherit.aes = FALSE, linewidth = 0.6, color = "black", alpha = br_alpha) +
geom_segment(aes(x = 2, xend = 2, y = y_mcq_br, yend = y_mcq_br - br_tick),
inherit.aes = FALSE, linewidth = 0.6, color = "black", alpha = br_alpha) +
annotate("text", x = 1.5, y = y_mcq_br + star_off, label = lab_mcq,
color = cols["MCQ accuracy"], size = 5) +
# ---- Slider bracket (higher) + star ----
geom_segment(aes(x = 1, xend = 2, y = y_slider_br, yend = y_slider_br),
inherit.aes = FALSE, linewidth = 0.6, color = "black", alpha = br_alpha) +
geom_segment(aes(x = 1, xend = 1, y = y_slider_br, yend = y_slider_br - br_tick),
inherit.aes = FALSE, linewidth = 0.6, color = "black", alpha = br_alpha) +
geom_segment(aes(x = 2, xend = 2, y = y_slider_br, yend = y_slider_br - br_tick),
inherit.aes = FALSE, linewidth = 0.6, color = "black", alpha = br_alpha) +
annotate("text", x = 1.5, y = y_slider_br + star_off, label = lab_slider,
color = cols["Slider response"], size = 5) +
theme_classic(base_size = 14) +
theme(
aspect.ratio       = 1,
axis.text.x        = element_text(size = 12),
axis.text.y        = element_text(size = 12),
legend.position    = "right", #c(0.98, 0.08),
legend.justification = c(1, 0),
legend.title       = element_text(size = 12),
legend.background  = element_rect(fill = scales::alpha("white", 0.75), color = NA)
) +
guides(color = guide_legend(override.aes = list(linetype = 0, shape = 16, size = 3)))
df_mcq <- as.data.frame(emm_speed) %>%
transmute(speed,
estimate = prob,
lower    = asymp.LCL,
upper    = asymp.UCL,
outcome  = "MCQ accuracy")
# Slider: continuous scale
df_slider <- as.data.frame(emm_speed_slider) %>%
transmute(speed,
estimate = emmean,
lower    = lower.CL,
upper    = upper.CL,
outcome  = "Slider response")
df_plot <- bind_rows(df_mcq, df_slider)
# --- significance labels (fast vs slow) ---
sig_lab <- function(p) ifelse(p < .001, "***",
ifelse(p < .01,  "**",
ifelse(p < .05,  "*",  "ns")))
p_mcq    <- as.data.frame(contrast(emm_speed,        method = "revpairwise"))$p.value[1]
p_slider <- as.data.frame(contrast(emm_speed_slider, method = "revpairwise"))$p.value[1]
lab_mcq     <- sig_lab(p_mcq)
lab_slider  <- sig_lab(p_slider)
# --- bracket geometry (kept close to dots; slider bracket a bit higher) ---
br_gap_mcq    <- 0.028     # above MCQ upper CI
br_gap_slider <- 0.055     # above Slider upper CI (further from dots)
br_tick       <- 0.018     # bracket tick length
star_off      <- 0.010     # stars closer to bracket
br_alpha      <- 0.2     # transparency for black brackets
y_mcq_br    <- pmin(0.97, max(df_mcq$upper,    na.rm = TRUE) + br_gap_mcq)
y_slider_br <- pmin(0.97, max(df_slider$upper, na.rm = TRUE) + br_gap_slider)
# if brackets too close, nudge slider one a touch more
if (abs(y_mcq_br - y_slider_br) < 0.03) y_slider_br <- pmin(0.97, y_mcq_br + 0.05)
# --- colors & legend text ---
cols <- c("MCQ accuracy"    = "#C2185B",  # deep pink
"Slider response" = "#6A3D9A")  # deep purple
legend_labels <- c("MCQ accuracy"    = "Multiple choice question",
"Slider response" = "Real-time comprehension")
# --- PLOT ---
ggplot(df_plot, aes(x = speed, y = estimate, group = outcome, color = outcome)) +
geom_line(linewidth = 1, show.legend = FALSE) +
geom_point(size = 3, shape = 16) +                                        # legend shows dots
geom_linerange(aes(ymin = lower, ymax = upper), linewidth = 0.9, show.legend = FALSE) +
scale_color_manual(values = cols, name = "Comprehension Measure", labels = legend_labels) +
# rename ticks: slow -> x1, fast -> x2.5
scale_x_discrete(labels = c(slow = "x1", fast = "x2.5"),
expand  = expansion(mult = c(0.05, 0.05))) +
scale_y_continuous(breaks = c(0, 0.5, 1), limits = c(0, 1)) +
coord_cartesian(clip = "off") +
labs(x = "Speech Rate", y = "Predicted Comprehension Score") +
# ---- MCQ bracket (semi-transparent black) + star ----
geom_segment(aes(x = 1, xend = 2, y = y_mcq_br, yend = y_mcq_br),
inherit.aes = FALSE, linewidth = 0.6, color = "black", alpha = br_alpha) +
geom_segment(aes(x = 1, xend = 1, y = y_mcq_br, yend = y_mcq_br - br_tick),
inherit.aes = FALSE, linewidth = 0.6, color = "black", alpha = br_alpha) +
geom_segment(aes(x = 2, xend = 2, y = y_mcq_br, yend = y_mcq_br - br_tick),
inherit.aes = FALSE, linewidth = 0.6, color = "black", alpha = br_alpha) +
annotate("text", x = 1.5, y = y_mcq_br + star_off, label = lab_mcq,
color = cols["MCQ accuracy"], size = 5) +
# ---- Slider bracket (higher) + star ----
geom_segment(aes(x = 1, xend = 2, y = y_slider_br, yend = y_slider_br),
inherit.aes = FALSE, linewidth = 0.6, color = "black", alpha = br_alpha) +
geom_segment(aes(x = 1, xend = 1, y = y_slider_br, yend = y_slider_br - br_tick),
inherit.aes = FALSE, linewidth = 0.6, color = "black", alpha = br_alpha) +
geom_segment(aes(x = 2, xend = 2, y = y_slider_br, yend = y_slider_br - br_tick),
inherit.aes = FALSE, linewidth = 0.6, color = "black", alpha = br_alpha) +
annotate("text", x = 1.5, y = y_slider_br + star_off, label = lab_slider,
color = cols["Slider response"], size = 5) +
theme_classic(base_size = 14) +
theme(
aspect.ratio       = 1,
axis.text.x        = element_text(size = 12),
axis.text.y        = element_text(size = 12),
legend.position = c(0.95, 0.95),  # Adjust these values for fine-tuning
legend.justification = c("right", "top"),
legend.justification = c(1, 0),
legend.title       = element_text(size = 12),
legend.background  = element_rect(fill = scales::alpha("white", 0.75), color = NA)
) +
guides(color = guide_legend(override.aes = list(linetype = 0, shape = 16, size = 3)))
df_mcq <- as.data.frame(emm_speed) %>%
transmute(speed,
estimate = prob,
lower    = asymp.LCL,
upper    = asymp.UCL,
outcome  = "MCQ accuracy")
# Slider: continuous scale
df_slider <- as.data.frame(emm_speed_slider) %>%
transmute(speed,
estimate = emmean,
lower    = lower.CL,
upper    = upper.CL,
outcome  = "Slider response")
df_plot <- bind_rows(df_mcq, df_slider)
# --- significance labels (fast vs slow) ---
sig_lab <- function(p) ifelse(p < .001, "***",
ifelse(p < .01,  "**",
ifelse(p < .05,  "*",  "ns")))
p_mcq    <- as.data.frame(contrast(emm_speed,        method = "revpairwise"))$p.value[1]
p_slider <- as.data.frame(contrast(emm_speed_slider, method = "revpairwise"))$p.value[1]
lab_mcq     <- sig_lab(p_mcq)
lab_slider  <- sig_lab(p_slider)
# --- bracket geometry (kept close to dots; slider bracket a bit higher) ---
br_gap_mcq    <- 0.028     # above MCQ upper CI
br_gap_slider <- 0.055     # above Slider upper CI (further from dots)
br_tick       <- 0.018     # bracket tick length
star_off      <- 0.010     # stars closer to bracket
br_alpha      <- 0.2     # transparency for black brackets
y_mcq_br    <- pmin(0.97, max(df_mcq$upper,    na.rm = TRUE) + br_gap_mcq)
y_slider_br <- pmin(0.97, max(df_slider$upper, na.rm = TRUE) + br_gap_slider)
# if brackets too close, nudge slider one a touch more
if (abs(y_mcq_br - y_slider_br) < 0.03) y_slider_br <- pmin(0.97, y_mcq_br + 0.05)
# --- colors & legend text ---
cols <- c("MCQ accuracy"    = "#C2185B",  # deep pink
"Slider response" = "#6A3D9A")  # deep purple
legend_labels <- c("MCQ accuracy"    = "Multiple choice question",
"Slider response" = "Real-time comprehension")
# --- PLOT ---
ggplot(df_plot, aes(x = speed, y = estimate, group = outcome, color = outcome)) +
geom_line(linewidth = 1, show.legend = FALSE) +
geom_point(size = 3, shape = 16) +                                        # legend shows dots
geom_linerange(aes(ymin = lower, ymax = upper), linewidth = 0.9, show.legend = FALSE) +
scale_color_manual(values = cols, name = "Comprehension Measure", labels = legend_labels) +
# rename ticks: slow -> x1, fast -> x2.5
scale_x_discrete(labels = c(slow = "x1", fast = "x2.5"),
expand  = expansion(mult = c(0.05, 0.05))) +
scale_y_continuous(breaks = c(0, 0.5, 1), limits = c(0, 1)) +
coord_cartesian(clip = "off") +
labs(x = "Speech Rate", y = "Predicted Comprehension Score") +
# ---- MCQ bracket (semi-transparent black) + star ----
geom_segment(aes(x = 1, xend = 2, y = y_mcq_br, yend = y_mcq_br),
inherit.aes = FALSE, linewidth = 0.6, color = "black", alpha = br_alpha) +
geom_segment(aes(x = 1, xend = 1, y = y_mcq_br, yend = y_mcq_br - br_tick),
inherit.aes = FALSE, linewidth = 0.6, color = "black", alpha = br_alpha) +
geom_segment(aes(x = 2, xend = 2, y = y_mcq_br, yend = y_mcq_br - br_tick),
inherit.aes = FALSE, linewidth = 0.6, color = "black", alpha = br_alpha) +
annotate("text", x = 1.5, y = y_mcq_br + star_off, label = lab_mcq,
color = cols["MCQ accuracy"], size = 5) +
# ---- Slider bracket (higher) + star ----
geom_segment(aes(x = 1, xend = 2, y = y_slider_br, yend = y_slider_br),
inherit.aes = FALSE, linewidth = 0.6, color = "black", alpha = br_alpha) +
geom_segment(aes(x = 1, xend = 1, y = y_slider_br, yend = y_slider_br - br_tick),
inherit.aes = FALSE, linewidth = 0.6, color = "black", alpha = br_alpha) +
geom_segment(aes(x = 2, xend = 2, y = y_slider_br, yend = y_slider_br - br_tick),
inherit.aes = FALSE, linewidth = 0.6, color = "black", alpha = br_alpha) +
annotate("text", x = 1.5, y = y_slider_br + star_off, label = lab_slider,
color = cols["Slider response"], size = 5) +
theme_classic(base_size = 14) +
theme(
aspect.ratio       = 1,
axis.text.x        = element_text(size = 12),
axis.text.y        = element_text(size = 12),
legend.position = c(0.95, 0.95),  # Adjust these values for fine-tuning
legend.justification = c("right", "top"),
#legend.justification = c(1, 0),
legend.title       = element_text(size = 12),
legend.background  = element_rect(fill = scales::alpha("white", 0.75), color = NA)
) +
guides(color = guide_legend(override.aes = list(linetype = 0, shape = 16, size = 3)))
df_mcq <- as.data.frame(emm_speed) %>%
transmute(speed,
estimate = prob,
lower    = asymp.LCL,
upper    = asymp.UCL,
outcome  = "MCQ accuracy")
# Slider: continuous scale
df_slider <- as.data.frame(emm_speed_slider) %>%
transmute(speed,
estimate = emmean,
lower    = lower.CL,
upper    = upper.CL,
outcome  = "Slider response")
df_plot <- bind_rows(df_mcq, df_slider)
# --- significance labels (fast vs slow) ---
sig_lab <- function(p) ifelse(p < .001, "***",
ifelse(p < .01,  "**",
ifelse(p < .05,  "*",  "ns")))
p_mcq    <- as.data.frame(contrast(emm_speed,        method = "revpairwise"))$p.value[1]
p_slider <- as.data.frame(contrast(emm_speed_slider, method = "revpairwise"))$p.value[1]
lab_mcq     <- sig_lab(p_mcq)
lab_slider  <- sig_lab(p_slider)
# --- bracket geometry (kept close to dots; slider bracket a bit higher) ---
br_gap_mcq    <- 0.028     # above MCQ upper CI
br_gap_slider <- 0.055     # above Slider upper CI (further from dots)
br_tick       <- 0.018     # bracket tick length
star_off      <- 0.010     # stars closer to bracket
br_alpha      <- 0.2     # transparency for black brackets
y_mcq_br    <- pmin(0.97, max(df_mcq$upper,    na.rm = TRUE) + br_gap_mcq)
y_slider_br <- pmin(0.97, max(df_slider$upper, na.rm = TRUE) + br_gap_slider)
# if brackets too close, nudge slider one a touch more
if (abs(y_mcq_br - y_slider_br) < 0.03) y_slider_br <- pmin(0.97, y_mcq_br + 0.05)
# --- colors & legend text ---
cols <- c("MCQ accuracy"    = "#C2185B",  # deep pink
"Slider response" = "#6A3D9A")  # deep purple
legend_labels <- c("MCQ accuracy"    = "Multiple choice question",
"Slider response" = "Real-time comprehension")
# --- PLOT ---
ggplot(df_plot, aes(x = speed, y = estimate, group = outcome, color = outcome)) +
geom_line(linewidth = 1, show.legend = FALSE) +
geom_point(size = 3, shape = 16) +                                        # legend shows dots
geom_linerange(aes(ymin = lower, ymax = upper), linewidth = 0.9, show.legend = FALSE) +
scale_color_manual(values = cols, name = "Comprehension Measure", labels = legend_labels) +
# rename ticks: slow -> x1, fast -> x2.5
scale_x_discrete(labels = c(slow = "x1", fast = "x2.5"),
expand  = expansion(mult = c(0.05, 0.05))) +
scale_y_continuous(breaks = c(0, 0.5, 1), limits = c(0, 1)) +
coord_cartesian(clip = "off") +
labs(x = "Speech Rate", y = "Predicted Comprehension Score") +
# ---- MCQ bracket (semi-transparent black) + star ----
geom_segment(aes(x = 1, xend = 2, y = y_mcq_br, yend = y_mcq_br),
inherit.aes = FALSE, linewidth = 0.6, color = "black", alpha = br_alpha) +
geom_segment(aes(x = 1, xend = 1, y = y_mcq_br, yend = y_mcq_br - br_tick),
inherit.aes = FALSE, linewidth = 0.6, color = "black", alpha = br_alpha) +
geom_segment(aes(x = 2, xend = 2, y = y_mcq_br, yend = y_mcq_br - br_tick),
inherit.aes = FALSE, linewidth = 0.6, color = "black", alpha = br_alpha) +
annotate("text", x = 1.5, y = y_mcq_br + star_off, label = lab_mcq,
color = cols["MCQ accuracy"], size = 5) +
# ---- Slider bracket (higher) + star ----
geom_segment(aes(x = 1, xend = 2, y = y_slider_br, yend = y_slider_br),
inherit.aes = FALSE, linewidth = 0.6, color = "black", alpha = br_alpha) +
geom_segment(aes(x = 1, xend = 1, y = y_slider_br, yend = y_slider_br - br_tick),
inherit.aes = FALSE, linewidth = 0.6, color = "black", alpha = br_alpha) +
geom_segment(aes(x = 2, xend = 2, y = y_slider_br, yend = y_slider_br - br_tick),
inherit.aes = FALSE, linewidth = 0.6, color = "black", alpha = br_alpha) +
annotate("text", x = 1.5, y = y_slider_br + star_off, label = lab_slider,
color = cols["Slider response"], size = 5) +
theme_classic(base_size = 14) +
theme(
aspect.ratio       = 1,
axis.text.x        = element_text(size = 12),
axis.text.y        = element_text(size = 12),
legend.position    = "right", #c(0.98, 0.08),
legend.justification = c(1, 1),
legend.title       = element_text(size = 12),
legend.background  = element_rect(fill = scales::alpha("white", 0.75), color = NA)
) +
guides(color = guide_legend(override.aes = list(linetype = 0, shape = 16, size = 3)))
suppressPackageStartupMessages({
library(dplyr); library(lme4); library(emmeans)
})
# ---- Aggregate MCQ to segment-level ----
agg_mcq <- df.data %>%
mutate(
mcq_bin = as.integer(multiple_choice_accuracy %in% c(TRUE, "TRUE", "True", 1)),
speed   = factor(ifelse(speech_rate == 1, "slow", "fast"), levels = c("slow","fast")),
base_story = if ("base_story" %in% names(.)) base_story else sub("_sped$", "", story_name),
digit_span_grp  = factor(digit_span_score),
digit_noise_grp = factor(digit_in_noise_score)
) %>%
filter(!is.na(mcq_bin), !is.na(speed),
!is.na(digit_span_grp), !is.na(digit_noise_grp)) %>%
group_by(participant, base_story, speed, digit_span_grp, digit_noise_grp) %>%
summarise(
n_correct = sum(mcq_bin, na.rm = TRUE),
n_total   = dplyr::n(),        # usually 5; handles any missing items
.groups   = "drop"
) %>%
filter(n_total > 0)
# ---- Binomial GLMM on counts ----
m_speed_agg <- glmer(
cbind(n_correct, n_total - n_correct) ~ speed +
(1 | digit_span_grp) + (1 | digit_noise_grp),
data = agg_mcq, family = binomial
# , control = glmerControl(optimizer="bobyqa", optCtrl=list(maxfun=2e5))
)
cat("\n=== Aggregated model (Binomial n) summary ===\n")
print(summary(m_speed_agg), corr = FALSE)
# ---- Estimated probabilities & fast/slow contrast ----
emm_speed_agg <- emmeans(m_speed_agg, ~ speed, type = "response")
cmp_speed_agg <- contrast(emm_speed_agg, method = "revpairwise")  # fast / slow
cat("\n=== Estimated probabilities by speed (aggregated) ===\n")
print(emm_speed_agg)
cat("\n=== Contrast (fast / slow) â€” aggregated ===\n")
print(cmp_speed_agg)
View(df.data)
